"""
A module for report generation in the reports package.
"""

from typing import Union

from reportlab.lib.pagesizes import letter
from reportlab.lib.styles import StyleSheet1, getSampleStyleSheet
from reportlab.lib.units import inch
from reportlab.platypus import Image, Paragraph, SimpleDocTemplate, Spacer

from schemas.data_type import DataType


def create_pdf_report(
    figure_paths: list[str],
    paragraphs: list[str],
    output_filename: str = 'report.pdf',
    data_type: DataType = DataType.FIGURES,
) -> None:
    """
    Creates a PDF report with given figures and paragraphs.
    :param figure_paths: A list of strings containing paths to figure images.
    :type figure_paths: list[str]
    :param paragraphs: A list of strings containing paragraphs of text.
    :type paragraphs: list[str]
    :param output_filename: The filename for the output PDF.
    :type output_filename: str
    :param data_type: The type of data, used to define the directory where
     figures are stored.
    :type data_type: DataType
    :return: None
    :rtype: NoneType
    """
    simple_doc_template = SimpleDocTemplate(output_filename, pagesize=letter)
    sample_style_sheet: StyleSheet1 = getSampleStyleSheet()
    story: list[Union[Paragraph, Spacer, Image]] = []
    style = sample_style_sheet["Normal"]
    for text in paragraphs:
        story.extend((Paragraph(text, style), Spacer(1, 12)))
    for filename in figure_paths:
        image: Image = Image(f"{data_type.value}{filename}")
        image.drawHeight = 6 * inch
        image.drawWidth = 8 * inch
        story.extend((image, Spacer(1, 12)))
    simple_doc_template.build(story)
